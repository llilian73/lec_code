2025-10-30 09:11:22,146 - INFO - 开始计算人均成本占GNI比例...
2025-10-30 09:11:22,147 - INFO - === 第一步：加载数据 ===
2025-10-30 09:11:22,147 - INFO - 开始加载人均成本数据...
2025-10-30 09:11:22,199 - INFO - 成功使用编码 'utf-8' 读取文件: country_yearly_per_cost_USD_PP.csv
2025-10-30 09:11:22,199 - INFO - 加载成本数据完成，共 172 个国家
2025-10-30 09:11:22,209 - INFO - 创建了 171 个国家的成本数据映射
2025-10-30 09:11:22,209 - INFO - 开始加载人均GNI数据...
2025-10-30 09:11:22,238 - INFO - 成功使用编码 'utf-8' 读取文件: API_NY.GNP.PCAP.KD_DS2_en_csv_v2_124220.csv
2025-10-30 09:11:22,238 - INFO - 加载GNI数据完成，共 266 个国家/地区
2025-10-30 09:11:22,251 - INFO - 创建了 206 个国家的GNI数据映射
2025-10-30 09:11:22,252 - INFO - 开始加载元数据...
2025-10-30 09:11:22,311 - INFO - 成功使用编码 'utf-8' 读取文件: Metadata_Country_API_NY.GNP.PCAP.KD_DS2_en_csv_v2_124220.csv
2025-10-30 09:11:22,311 - INFO - 加载元数据完成，共 265 个国家/地区
2025-10-30 09:11:22,323 - INFO - 创建了 220 个国家的元数据映射
2025-10-30 09:11:22,323 - INFO - === 第二步：处理数据 ===
2025-10-30 09:11:22,324 - INFO - 开始处理数据并计算比例...
2025-10-30 09:11:22,324 - INFO - 成功匹配: 161 个国家
2025-10-30 09:11:22,324 - INFO - 缺少GNI数据: 10 个
2025-10-30 09:11:22,324 - INFO - 缺少元数据: 0 个
2025-10-30 09:11:22,324 - INFO - === 第三步：保存结果 ===
2025-10-30 09:11:22,325 - INFO - 开始保存结果...
2025-10-30 09:11:22,377 - INFO - 输出CSV文件的列顺序: ['IncomeGroup', 'Country Name', 'Country Code_2', 'total_cost', 'GNI_per', 'propotion_to_GNI']
2025-10-30 09:11:22,378 - INFO - 结果已保存至: Z:\local_environment_creation\cost\country_cost_proportion_to_GNI.csv
2025-10-30 09:11:22,378 - INFO - 共保存 161 个国家/地区的数据
2025-10-30 09:11:22,378 - INFO - === 统计信息 ===
2025-10-30 09:11:22,378 - INFO - 比例范围: 0.000335 - 0.076717
2025-10-30 09:11:22,379 - INFO - 平均比例: 0.011417
2025-10-30 09:11:22,379 - INFO - 中位数比例: 0.006459
2025-10-30 09:11:22,379 - INFO - 
按IncomeGroup统计:
2025-10-30 09:11:22,384 - INFO -   High income: 平均比例 0.001518, 中位数比例 0.000960, 国家数 52
2025-10-30 09:11:22,385 - INFO -   Low income: 平均比例 0.037060, 中位数比例 0.035403, 国家数 22
2025-10-30 09:11:22,386 - INFO -   Lower middle income: 平均比例 0.014750, 中位数比例 0.012286, 国家数 44
2025-10-30 09:11:22,386 - INFO -   Upper middle income: 平均比例 0.006294, 中位数比例 0.005021, 国家数 42
2025-10-30 09:11:22,387 - INFO - 
比例最高的前10个国家:
2025-10-30 09:11:22,391 - INFO -   Afghanistan (AF): 0.076717
2025-10-30 09:11:22,392 - INFO -   Burundi (BI): 0.069706
2025-10-30 09:11:22,392 - INFO -   Central African Republic (CF): 0.058864
2025-10-30 09:11:22,392 - INFO -   Kyrgyz Republic (KG): 0.053412
2025-10-30 09:11:22,393 - INFO -   Madagascar (MG): 0.048258
2025-10-30 09:11:22,393 - INFO -   Congo, Dem. Rep. (CD): 0.047743
2025-10-30 09:11:22,393 - INFO -   Niger (NE): 0.045693
2025-10-30 09:11:22,394 - INFO -   Malawi (MW): 0.040134
2025-10-30 09:11:22,394 - INFO -   Syrian Arab Republic (SY): 0.038795
2025-10-30 09:11:22,394 - INFO -   Tajikistan (TJ): 0.038741
2025-10-30 09:11:22,394 - INFO - 
比例最低的前10个国家:
2025-10-30 09:11:22,396 - INFO -   Qatar (QA): 0.000335
2025-10-30 09:11:22,396 - INFO -   Switzerland (CH): 0.000432
2025-10-30 09:11:22,397 - INFO -   Australia (AU): 0.000470
2025-10-30 09:11:22,397 - INFO -   Luxembourg (LU): 0.000475
2025-10-30 09:11:22,397 - INFO -   Norway (NO): 0.000506
2025-10-30 09:11:22,397 - INFO -   United Arab Emirates (AE): 0.000527
2025-10-30 09:11:22,398 - INFO -   Ireland (IE): 0.000554
2025-10-30 09:11:22,398 - INFO -   Denmark (DK): 0.000565
2025-10-30 09:11:22,398 - INFO -   United Kingdom (GB): 0.000647
2025-10-30 09:11:22,398 - INFO -   Israel (IL): 0.000655
2025-10-30 09:11:22,399 - INFO - 计算完成！
2025-10-30 09:39:21,327 - INFO - 开始计算人均成本占GNI比例...
2025-10-30 09:39:21,328 - INFO - === 第一步：加载数据 ===
2025-10-30 09:39:21,328 - INFO - 开始加载人均成本数据...
2025-10-30 09:39:21,367 - INFO - 成功使用编码 'utf-8' 读取文件: country_yearly_per_cost_USD_PP.csv
2025-10-30 09:39:21,368 - INFO - 加载成本数据完成，共 172 个国家
2025-10-30 09:39:21,368 - INFO - 检测到成本文件中包含'PP'列，将提取PP数据
2025-10-30 09:39:21,379 - INFO - 创建了 171 个国家的成本数据映射
2025-10-30 09:39:21,379 - INFO - 开始加载人均GNI数据...
2025-10-30 09:39:21,405 - INFO - 成功使用编码 'utf-8' 读取文件: API_NY.GNP.PCAP.KD_DS2_en_csv_v2_124220.csv
2025-10-30 09:39:21,406 - INFO - 加载GNI数据完成，共 266 个国家/地区
2025-10-30 09:39:21,418 - INFO - 创建了 206 个国家的GNI数据映射
2025-10-30 09:39:21,419 - INFO - 开始加载元数据...
2025-10-30 09:39:21,452 - INFO - 成功使用编码 'utf-8' 读取文件: Metadata_Country_API_NY.GNP.PCAP.KD_DS2_en_csv_v2_124220.csv
2025-10-30 09:39:21,452 - INFO - 加载元数据完成，共 265 个国家/地区
2025-10-30 09:39:21,466 - INFO - 创建了 220 个国家的元数据映射
2025-10-30 09:39:21,466 - INFO - === 第二步：处理数据 ===
2025-10-30 09:39:21,466 - INFO - 开始处理数据并计算比例...
2025-10-30 09:39:21,467 - INFO - 成功匹配: 161 个国家
2025-10-30 09:39:21,467 - INFO - 缺少GNI数据: 10 个
2025-10-30 09:39:21,467 - INFO - 缺少元数据: 0 个
2025-10-30 09:39:21,467 - INFO - === 第三步：保存结果 ===
2025-10-30 09:39:21,468 - INFO - 开始保存结果...
2025-10-30 09:39:21,557 - INFO - 输出CSV文件的列顺序: ['IncomeGroup', 'Country Name', 'Country Code_2', 'total_cost', 'GNI_per', 'propotion_to_GNI', 'PP']
2025-10-30 09:39:21,557 - INFO - 结果已保存至: Z:\local_environment_creation\cost\country_cost_proportion_to_GNI.csv
2025-10-30 09:39:21,557 - INFO - 共保存 161 个国家/地区的数据
2025-10-30 09:39:21,558 - INFO - === 统计信息 ===
2025-10-30 09:39:21,558 - INFO - 比例范围: 0.000335 - 0.076717
2025-10-30 09:39:21,558 - INFO - 平均比例: 0.011417
2025-10-30 09:39:21,558 - INFO - 中位数比例: 0.006459
2025-10-30 09:39:21,558 - INFO - 
按IncomeGroup统计:
2025-10-30 09:39:21,561 - INFO -   High income: 平均比例 0.001518, 中位数比例 0.000960, 国家数 52
2025-10-30 09:39:21,561 - INFO -   Low income: 平均比例 0.037060, 中位数比例 0.035403, 国家数 22
2025-10-30 09:39:21,562 - INFO -   Lower middle income: 平均比例 0.014750, 中位数比例 0.012286, 国家数 44
2025-10-30 09:39:21,563 - INFO -   Upper middle income: 平均比例 0.006294, 中位数比例 0.005021, 国家数 42
2025-10-30 09:39:21,563 - INFO - 
比例最高的前10个国家:
2025-10-30 09:39:21,564 - INFO -   Afghanistan (AF): 0.076717
2025-10-30 09:39:21,564 - INFO -   Burundi (BI): 0.069706
2025-10-30 09:39:21,564 - INFO -   Central African Republic (CF): 0.058864
2025-10-30 09:39:21,566 - INFO -   Kyrgyz Republic (KG): 0.053412
2025-10-30 09:39:21,566 - INFO -   Madagascar (MG): 0.048258
2025-10-30 09:39:21,566 - INFO -   Congo, Dem. Rep. (CD): 0.047743
2025-10-30 09:39:21,566 - INFO -   Niger (NE): 0.045693
2025-10-30 09:39:21,567 - INFO -   Malawi (MW): 0.040134
2025-10-30 09:39:21,567 - INFO -   Syrian Arab Republic (SY): 0.038795
2025-10-30 09:39:21,567 - INFO -   Tajikistan (TJ): 0.038741
2025-10-30 09:39:21,567 - INFO - 
比例最低的前10个国家:
2025-10-30 09:39:21,569 - INFO -   Qatar (QA): 0.000335
2025-10-30 09:39:21,569 - INFO -   Switzerland (CH): 0.000432
2025-10-30 09:39:21,569 - INFO -   Australia (AU): 0.000470
2025-10-30 09:39:21,569 - INFO -   Luxembourg (LU): 0.000475
2025-10-30 09:39:21,570 - INFO -   Norway (NO): 0.000506
2025-10-30 09:39:21,570 - INFO -   United Arab Emirates (AE): 0.000527
2025-10-30 09:39:21,570 - INFO -   Ireland (IE): 0.000554
2025-10-30 09:39:21,570 - INFO -   Denmark (DK): 0.000565
2025-10-30 09:39:21,571 - INFO -   United Kingdom (GB): 0.000647
2025-10-30 09:39:21,571 - INFO -   Israel (IL): 0.000655
2025-10-30 09:39:21,571 - INFO - 计算完成！
2025-11-05 15:31:21,651 - INFO - 开始计算人均成本占GNI比例...
2025-11-05 15:31:21,652 - INFO - === 第一步：加载数据 ===
2025-11-05 15:31:21,652 - INFO - 开始加载人均成本数据...
2025-11-05 15:31:21,806 - INFO - 成功使用编码 'latin-1' 读取文件: country_yearly_per_cost_USD_PP.csv
2025-11-05 15:31:21,806 - INFO - 加载成本数据完成，共 172 个国家
2025-11-05 15:31:21,806 - INFO - 检测到成本文件中包含'PP'列，将提取PP数据
2025-11-05 15:31:21,816 - INFO - 创建了 172 个国家的成本数据映射
2025-11-05 15:31:21,816 - INFO - 开始加载人均GNI数据...
2025-11-05 15:31:21,931 - INFO - 成功使用编码 'utf-8' 读取文件: API_NY.GNP.PCAP.KD_DS2_en_csv_v2_124220.csv
2025-11-05 15:31:21,931 - INFO - 加载GNI数据完成，共 266 个国家/地区
2025-11-05 15:31:21,949 - INFO - 创建了 207 个国家的GNI数据映射
2025-11-05 15:31:21,950 - INFO - 开始加载元数据...
2025-11-05 15:31:22,069 - INFO - 成功使用编码 'latin-1' 读取文件: Metadata_Country_API_NY.GNP.PCAP.KD_DS2_en_csv_v2_124220.csv
2025-11-05 15:31:22,069 - INFO - 加载元数据完成，共 265 个国家/地区
2025-11-05 15:31:22,082 - INFO - 创建了 224 个国家的元数据映射
2025-11-05 15:31:22,083 - INFO - === 第二步：处理数据 ===
2025-11-05 15:31:22,083 - INFO - 开始处理数据并计算比例...
2025-11-05 15:31:22,083 - INFO - 成功匹配: 162 个国家
2025-11-05 15:31:22,083 - INFO - 缺少GNI数据: 10 个
2025-11-05 15:31:22,084 - INFO - 缺少元数据: 0 个
2025-11-05 15:31:22,084 - INFO - === 第三步：保存结果 ===
2025-11-05 15:31:22,084 - INFO - 开始保存结果...
2025-11-05 15:31:22,259 - INFO - 输出CSV文件的列顺序: ['IncomeGroup', 'Country Name', 'Country Code_2', 'total_cost', 'GNI_per', 'propotion_to_GNI', 'PP']
2025-11-05 15:31:22,259 - INFO - 结果已保存至: Z:\local_environment_creation\cost\method2\country_cost_proportion_to_GNI.csv
2025-11-05 15:31:22,259 - INFO - 共保存 162 个国家/地区的数据
2025-11-05 15:31:22,259 - INFO - === 统计信息 ===
2025-11-05 15:31:22,260 - INFO - 比例范围: 0.000565 - 0.070477
2025-11-05 15:31:22,260 - INFO - 平均比例: 0.010898
2025-11-05 15:31:22,260 - INFO - 中位数比例: 0.005909
2025-11-05 15:31:22,260 - INFO - 
按IncomeGroup统计:
2025-11-05 15:31:22,263 - INFO -   : 平均比例 0.029321, 中位数比例 0.029321, 国家数 1
2025-11-05 15:31:22,264 - INFO -   High income: 平均比例 0.002251, 中位数比例 0.001793, 国家数 52
2025-11-05 15:31:22,264 - INFO -   Low income: 平均比例 0.035220, 中位数比例 0.032761, 国家数 22
2025-11-05 15:31:22,265 - INFO -   Lower middle income: 平均比例 0.013477, 中位数比例 0.011555, 国家数 45
2025-11-05 15:31:22,265 - INFO -   Upper middle income: 平均比例 0.005662, 中位数比例 0.005200, 国家数 42
2025-11-05 15:31:22,265 - INFO - 
比例最高的前10个国家:
2025-11-05 15:31:22,267 - INFO -   Burundi (BI): 0.070477
2025-11-05 15:31:22,267 - INFO -   Afghanistan (AF): 0.057632
2025-11-05 15:31:22,267 - INFO -   Central African Republic (CF): 0.056880
2025-11-05 15:31:22,268 - INFO -   Liberia (LR): 0.049284
2025-11-05 15:31:22,268 - INFO -   Congo, Dem. Rep. (CD): 0.045221
2025-11-05 15:31:22,268 - INFO -   Madagascar (MG): 0.043803
2025-11-05 15:31:22,268 - INFO -   Niger (NE): 0.043093
2025-11-05 15:31:22,268 - INFO -   Kyrgyz Republic (KG): 0.039704
2025-11-05 15:31:22,269 - INFO -   Malawi (MW): 0.038666
2025-11-05 15:31:22,269 - INFO -   Mozambique (MZ): 0.035837
2025-11-05 15:31:22,269 - INFO - 
比例最低的前10个国家:
2025-11-05 15:31:22,270 - INFO -   Iceland (IS): 0.000565
2025-11-05 15:31:22,270 - INFO -   Qatar (QA): 0.000807
2025-11-05 15:31:22,272 - INFO -   Brunei Darussalam (BN): 0.000819
2025-11-05 15:31:22,272 - INFO -   Australia (AU): 0.000994
2025-11-05 15:31:22,272 - INFO -   Luxembourg (LU): 0.001025
2025-11-05 15:31:22,272 - INFO -   Norway (NO): 0.001170
2025-11-05 15:31:22,272 - INFO -   United Arab Emirates (AE): 0.001250
2025-11-05 15:31:22,272 - INFO -   Switzerland (CH): 0.001279
2025-11-05 15:31:22,272 - INFO -   Ireland (IE): 0.001290
2025-11-05 15:31:22,272 - INFO -   Japan (JP): 0.001309
2025-11-05 15:31:22,273 - INFO - 计算完成！
